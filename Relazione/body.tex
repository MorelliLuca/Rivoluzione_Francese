\begin{center}
	\huge \textbf{Il modello PRNR}
	
	\rule{7cm}{0.4pt} 
	
	\LARGE Un modello matematico per la Rivoluzione Francese
	
	\vspace{20pt}
	
	\LARGE \textbf{Cristina Caprioglio, Luca Morelli}
	
	\vspace{5pt}
	
	\LARGE 20 Dicembre 2022
	
	\vspace{20pt}
 
	\normalsize\textbf{Abstract:}\\
\end{center}
Per questo progetto abbiamo cercato di modellizzare lo scoppio di una rivoluzione. Per farlo ci siamo serviti del modello multicompartimentale, che ci ha permesso di descrivere le possibili transizioni di stato delle persone di una popolazione...

\vspace{20pt}

\section*{Introduzione}
L'evoluzione di vari gruppi eterogenei all'interno di una popolazione ...
\section{Il sistema e il modello}
Come precedentemente detto, vogliamo studiare la dinamica di una popolazione composta da vari membri, in numero elevato, che differiscono l'uno dall'altro per il loro reddito. Queste differenze, sotto determinate condizioni, possono spingere gli individui appartenenti alla categoria più povera ad insorgere. Questa insurrezione può a sua volta portare alcuni tra i più abbienti a reprimerla con l'uso della forza.\\

Per modellizzare una popolazione eterogenea abbiamo deciso di suddividerla in due categorie, \textbf{Poveri} e \textbf{Nobili}, per le quali si considera un reddito medio caratteristico di ciascuna categoria.\\
Ogni membro di questa popolazione può decidere, in base a vari fattori, di far uso della violenza per far valere le esigenze della propria categoria. Abbiamo considerato che ogni individuo può trovarsi o in uno stato di normalità o in uno stato eccitato: un membro della categoria dei Poveri nello stato \textbf{Normale} $(N_P)$ può transire allo stato di \textbf{Rivoluzionario} $(R)$, mentre un membro della categoria dei Nobili nello stato \textbf{Normale} $(N_N)$ può transire allo stato di \textbf{Reazionario} $(\bar{R})$. All'interno della stessa categoria può avvenire anche la transizione inversa, come mostrato in figura \ref{fig:CompartmentScheme}.\\
\begin{figure}[H]
	\centering
	\begin{tikzpicture}
        \draw[draw=black] (0,0) rectangle (2,1);
		\draw[->, thick] (2.2,.7) -- (3.8,.7);
		\draw[<-, thick] (2.2,.3) -- (3.8,.3);
		\draw[draw=black] (4,0) rectangle (6,1) ;
		\node at (5,0.5) {$\bar{R}$};
		\node at (1,0.5) {$N_N$};
		\draw[draw=black] (0,1.5) rectangle (2,2.5);
		\draw[->, thick] (2.2,2.2) -- (3.8,2.2);
		\draw[<-, thick] (2.2,1.8) -- (3.8,1.8);
		\draw[draw=black] (4,1.5) rectangle (6,2.5) ;
		\node at (5,2) {$R$};
		\node at (1,2) {$N_P$};
    \end{tikzpicture}
	\label{fig:CompartmentScheme}
	\caption{Schema a compartimenti delle categorie delle persone. Con le frecce sono evidenziate le transizioni di stato che un individuo può effettuare.}
\end{figure}
Per questa modellizazione abbiamo deciso, come è consueto fare, di trascurare le possibili fluttuazioni del numero totale di individui dovuti alla morte e alla nascita di persone, inoltre abbiamo considerato che un individuo non possa transire dalla categoria di Povero a quella di Nobile. Questa scelta è giustificata dall'osservazione che, seppur possibili, tali transizioni in genere sono estremamente rare. Tali considerazioni ci hanno quindi permesso di identificare 3 vincoli da imporre al modello:
\begin{equation}
    \frac{N_P(t)+R(t)}{N_P(0)+R(0)+N_N(0)+\bar{R}(0)}=F_P \quad\:\frac{N_N(t)+\bar{R}(t)}{N_P(0)+R(0)+N_N(0)+\bar{R}(0)}=F_N \quad\: F_P+F_N=1 
	\label{vincoli}
\end{equation}
dove $F_P$ e $F_N$ sono rispettivamente le frazioni di individui Poveri e Nobili sulla popolazione totale.\\

Dobbiamo ora identificare quali equazioni regolino la dinamica del sistema. Per fare ciò abbiamo ragionevolmente supposto che:
\begin{itemize}
	\item un Povero possa transire allo stato di Rivoluzionario o di sua spontanea iniziativa (nata della sua condizione disagiata) oppure incontrando un rivoluzionario che lo convinca ad insorgere,
	\item un Rivoluzionario, incontrando dei Reazionari, possa essere convinto a non perseguire più la sua causa ritornando allo stato Normale,
	\item un Nobile, incontrando un rivoluzionario, possa in risposta decidere di diventare un Reazionario,
	\item un Reazionario, vedendo diminuire il numero di Rivoluzionari (e quindi aumentare quello di Poveri allo stato normale), possa decidere di ritornare anch'esso allo stato normale,
\end{itemize}
Se consideriamo un tempo $\Delta t$ possiamo esprimere le variazioni del numero di ogni compartimento, tenendo conto delle precedenti considerazioni, con:

\begin{equation}\label{modelloDiscreto}
	\begin{aligned}
		 &R(t+\Delta t)-R(t)=\Gamma N_P(t) \frac{R(t)}{N_{tot}}\Delta t+\gamma N_P(t)\Delta t-\bar{\Gamma}R(t)\frac{\bar{R}(t)}{N_{tot}}\Delta t\\
		&\bar{R}(t+\Delta t)-\bar{R}(t)=\alpha N_N(t)\frac{R(t)}{N_{tot}}\Delta t-\beta \bar{R}(t)\frac{N_P(t)}{N_{tot}}\Delta t\\
		&N_P(t+\Delta t)-N_P(t)=-(R(t+\Delta t)-R(t))\\
		&N_N(t+\Delta t)-N_N(t)=-(\bar{R}(t+\Delta t)-\bar{R}(t))\\
	\end{aligned}     
\end{equation}	
dove $ \Gamma $ é un parametro che stima la probabilità che un povero diventi rivoluzionario incontrando altri rivoluzionari, mentre invece $ \bar{\Gamma} $ stima la probabilità che un rivoluzionario, per via della presenza di reazionari, ritorni allo stato Normale.  Diversamente dai precedenti parametri $\gamma$ stima la probabilità che un povero diventi rivoluzionario per volontà propria, senza influenze esterne. Infine $ \alpha $ e $ \beta $ sono i due parametri relativi alla variazione dei reazionari: il primo riguarda la probabilità che un nobile diventi reazionario mentre il secondo che un reazionario torni allo stato Normale. \\
Ogni parametro è quindi moltiplicato per la probabilità che il singolo individuo ne incontri un secondo che possa indurlo a transire, per esempio un povero incontri un rivoluzionario, questa probabilità è stimata dalla frazione dei secondi sulla popolazione totale. Per ottenere il numero di individui che transiscono è quindi necessario moltiplicare questa per il numero di persone che potenzialmente possono effettuare la transizione. Infine è opportuno osservare che queste probabilità sono stimate per unità di tempo, così che ogni addendo va moltiplicato per $\Delta t$ così da ottenere le variazioni di popolazione di ogni compartimento nel tempo $\Delta t$.\\


Si osservi che, essendo lineare il sistema che abbiamo appena descritto, riscalando di un fattore $\lambda$ tutta la poplazione le equazioni \ref{modelloDiscreto} non mutano forma, questo ci ha permesso di riscalare le variabili dividendole per $ N_{tot}$, che indica la popolazione totale, in questo modo otteniamo un sistema di equazioni differenziali che esprime come variano le frazioni di ogni categoria di persone sulla popolazione totale:  

\begin{equation} \label{eq: 1.3}
	\begin{aligned}
		&R'(t+\Delta t)-R'(t)=\Gamma N'_P(t)'R'(t)\Delta t+\gamma N'_P(t)\Delta t-\bar{\Gamma}R'(t)\bar{R'}(t)\Delta t\\
	&\bar{R'}(t+\Delta t)-\bar{R'}(t)=\alpha N'_N(t)R'(t)\Delta t-\beta \bar{R'}(t)N'_P(t)\Delta t\\
	&N'_P(t+\Delta t)-N'_P(t)=-(R'(t+\Delta t)-R'(t))\\
	&N'_N(t+\Delta t)-N'_N(t)=-(\bar{R'}(t+\Delta t)-\bar{R'}(t))\\
	\end{aligned}
\end{equation}	
con 
\begin{equation*}
	N'_{P}(t)=\frac{N_{P}(t)}{N_{tot}} \qquad 	N'_{N}(t)=\frac{N_{N}(t)}{N_{tot}} \qquad	R'(t)=\frac{R(t)}{N_{tot}} \qquad	\bar{R'}(t)=\frac{\bar{R}(t)}{N_{tot}} 
\end{equation*}
Per alleggerire la notazione, dato che da questo momento in poi useremo spesso le variabili riscalate, quest'ultime perderanno il simbolo "$ ' $" e verranno scritte normalmente, indicheremo quindi in che modo vadano intese le notazioni. \\
%
%All'interno della simulazione, visto che si calcolava la probabilità di ogni singolo individuo di compiere una transizione e non la variazione nel tempo dell'intero settore, tutti i parametri (con l'eccezione di $ \gamma $) sono stati divisi per 8. Questo perchè, calcolando la probabilità che avvenga una transizione, se la prima è influenzata dalla presenza o meno di un membro appartenente ad una certa categoria, andrà moltiplicata per la probabilità di incontrarlo. Nel nostro caso, ogni persona poteva interagire solo con le 8 celle adiacenti, perciò abbiamo dovuto moltiplicare per $ \frac{1}{8} $.
%\textbf{(NON SAREBBE MEGLIO METTERLO DOPO?)}
\\\\ 
Per poter studiare il nostro modello abbiamo diviso ogni espressione per $ \Delta t $ e, considerando intervalli di tempo abbastanza piccoli, abbiamo ottenuto un sistema di equazioni differenziali tramite il passaggio al continuo:
\begin{equation} \label{eq:1.4}
		\begin{aligned}
			&\frac{dR}{dt}=\Gamma N_P(t) R(t)+\gamma N_P(t)-\bar{\Gamma}R(t)\bar{R}(t)\\
		&\frac{d\bar{R}}{dt}=\alpha N_N(t)R(t)-\beta \bar{R}(t)N_P(t)\\
		&\frac{dN_{P}}{dt}= -\frac{dR}{dt}\\
		&\frac{dN_{R}}{dt}= -\frac{d\bar{R}}{dt}\\
		\end{aligned}
\end{equation}
\textbf{Punti di Equilibrio - Esistono e come li calcoliamo}
\section{Simulazione}
Per verificare la validità del modello matematico appena descritto abbiamo deciso di effettuare una simulazione al calcolatore di una dinamica di popolazione. Le equazioni (\ref{modelloDiscreto}), per la loro natura discreta, si adattano molto bene al modello dell'automa cellulare: una popolazione è rappresentata in questo modello da una griglia di celle, ognuna corrispondente ad un individuo che può trovarsi in un determinato stato.
\begin{center}
	\begin{tikzpicture}[scale=0.7]
		\draw[fill=green] (0,0) rectangle (5,5);
		\draw[fill=green] (9.99,0) rectangle (15,5);
		\draw[step=0.5cm] (0,0) grid (5,5);
		\draw[step=0.5cm] (9.99,0) grid (15,5);
		
		\filldraw[fill=red] (1,1) rectangle (1.5,1.5);
		\filldraw[fill=red] (3,4) rectangle (3.5,4.5);
		\filldraw[fill=red] (4,1.5) rectangle (4.5,2);
		\filldraw[fill=red] (2,4.5) rectangle (2.5,5);
		\filldraw[fill=red] (2.5,2.5) rectangle (3,3);
		\filldraw[fill=red] (3,2.5) rectangle (3.5,3);
		
		\draw[->,thick] (5.5,2.5) -- (9.5,2.5);
		\node[fill=white,scale=0.8] at (7.5,2.5) {Evoluzione $\Delta t$};
		
		\filldraw[fill=red] (10.99,1) rectangle (11.49,1.5);
		\filldraw[fill=red] (12.99,4) rectangle (13.49,4.5);
		\filldraw[fill=red] (13.99,1.5) rectangle (14.49,2);
		\filldraw[fill=red] (11.99,4.5) rectangle (12.49,5);
		\filldraw[fill=red] (12.49,4) rectangle (12.99,4.5);
		\filldraw[fill=red] (11.49,1) rectangle (11.99,1.5);
		\filldraw[fill=red] (9.99,1) rectangle (10.49,1.5);
		\filldraw[fill=red] (13.99,4) rectangle (14.49,4.5);
		\filldraw[fill=red] (13.99,2.5) rectangle (14.49,3);
		\filldraw[fill=red] (11.99,3.5) rectangle (12.49,4);
		\filldraw[fill=red] (12.49,3.5) rectangle (12.99,4);
		\filldraw[fill=red] (10.99,1) rectangle (11.49,1.5);
		
		\draw[<-,thick] (4.25,1.75) -- (7,1);
		\node[fill=white,scale=0.8] at (7,1) {Individuo};
	\end{tikzpicture}
\end{center}
La simulazione che abbiamo realizzato fa variare lo stato di ogni cella secondo le equazioni (\ref{modelloDiscreto}) ad intervalli di tempo discreto $\Delta t$: ogni cella interagisce con quelle adiacenti\footnote{Nel nostro caso ogni cella ha 8 celle adiacenti che vengono considerate.} simulando l'incontro con altri individui, così facendo per ogni individuo, tra queste, che può indurre un transizione di stato viene probabilisticamente determinato se questa debba aver luogo o meno e si modifica quindi lo stato della cella. Il carattere probabilistico è determinato di parametri $\Gamma,\ \bar{\Gamma},\ \gamma,\ \alpha $ e $\beta$, è stato però necessario tener conto delle limitazioni della simulazione, infatti una cella può realmente interagire solamente con le otto adiacenti e non con tutta la popolazione, per questo le probabilità di transizione nelle equazioni (\ref{modelloDiscreto}) sono state riscalate di un fattore $\frac{1}{8}$ quando utilizzate nella simulazione.  \\ 
Abbiamo eseguito diversi test con i seguenti parametri:

\textbf{(INSERISCI GRAFICI E RAGIONE DEL PERCHè PROPRIO QUEI PARAMETRI)}
\section{Integrazione}
Le equazioni (\ref{eq:1.4}) che abbiamo descritto nella sezione \emph{label} non sono facilmente risolvibili, per questo motivo può essere opportuno integrarle numericamente. Il metodo utilizzato per l'integrazione é quello di Runge-Kutta al quarto ordine, il quale permette di approssimare una funzione conoscendone la derivata prima rispetto al tempo e le condizioni iniziali\footnote{Per una spiegazione dettagliata si veda l'appendice A}. \\
Considerando come unità di tempo i giorni e utilizzando un passo di integrazione di $ h=0.01 \text{ giorni}$ siamo riusciti ad ottenere l'andamento di $ N_{P}, N_{N}, R$ e $\bar{R} $ nel tempo secondo le equazioni (\ref{eq:1.4}) per diversi valori iniziali e paramenti di simulazione.
I risultati che abbiamo così  ottenuto possono essere paragonati a quelli ottenuti tramite l'automa, questo confronto è esemplificato nei grafici \emph{label} nei quali sono riportati sia i risultati della simulazione che quelli dell'integrazione per lo stesso set di parametri.\\ 

Come si può vedere i risultati sono in accordo tra di loro il che ci consente di affermare che il modello matematico che abbiamo descritto costituisce una buona descrizione di una dinamica di interazione sociale.
\section{Modulazione dei parametri}
Al fine di rendere il modello più realistico abbiamo deciso di rendere variabili i parametri relativi alla variazione dei rivoluzionari. Per prima cosa abbiamo definito una funzione che stima la differenza media di ricchezza posseduta tra un nobile e un povero $\Delta\text{Pil}$, questa ha una dipendenza temporale che può quindi influenzare lo stato della popolazione simulando vari scenari come periodi di carestie o interventi sociali da parte dello stato.\\
Inoltre abbiamo introdotto un paramento $\sigma$ che misura la suscettibilità dei poveri alle condizioni loro condizioni economiche nell'ambiente sociale, nella fattispecie questo tiene conto di come pochi poveri non saranno molto propensi all'insurrezione mentre se è la maggior parte della popolazione a trovarsi in condizione povertà tale evento è più facile che si verifichi. Abbiamo assunto che tale parametro sia stiamo dalla seguente funzione: 
\begin{equation}
	\sigma= \sigma_0\left(1-\exp\left\{-\frac{F_P}{F_R}\right\}\right)
\end{equation}
Alla luce di queste considerazioni le probabilità di transizione diventano dipendenti da $\sigma$ e $\Delta\text{Pil}$:
\begin{flalign*}
	&\Gamma=\Gamma_{0}\cdot\tanh\left(\frac{\sigma\cdot PIL}{300}\right)\\\nonumber
	&\gamma=\gamma_{0}\cdot\tanh\left(\sigma\cdot PIL\right)\\\nonumber
	&\bar{\Gamma}=\bar{\Gamma}_{0}\cdot\tanh\left(\frac{1}{\sigma\cdot PIL}\right)\\\nonumber
\end{flalign*}
con questi andamenti funzionali abbiamo voluto tener conto di come la probabilità di transire in uno stato di insurrezione di un individuo sia massima quando le condizioni di povertà diventano estreme per buona parte della popolazione.\\
\textbf{Carestie periodiche}\\
\begin{equation}
	\Delta\text{Pil}(t)=\Delta\text{Pil}_0\sin(2\pi\nu t) \qquad (\nu=\text{Frequenza carestia })
\end{equation}
\textbf{Sussidi statali}\\
\begin{equation}
	\Delta\text{Pil}(t)=
	\begin{cases}
		\Delta\text{Pil}_0 \qquad \quad \text{Se $R(t)$ non è mai salito oltre un livello soglia $\tilde{R}$}\\
		\Delta\text{Pil}_0\ e^{-\frac{t}{\lambda}} \quad \text{Altrimenti}\qquad     \text{($\lambda=$Rapidità intervento)}
	\end{cases}
\end{equation}
\textbf{Carestie con sussidi}
\begin{equation}
	\Delta\text{Pil}(t)=
	\begin{cases}
		\Delta\text{Pil}_0\sin(2\pi\nu t) \qquad \quad \text{Se $R(t)$ non è mai salito oltre un livello soglia $\tilde{R}$}\\
		\Delta\text{Pil}_0\sin(2\pi\nu t)e^{-\frac{t}{\lambda}} \quad \text{Altrimenti}\quad     \text{ ($\lambda=$Rapidità intervento, $\nu=$Frequenza carestia)}
	\end{cases}
\end{equation}

\newpage
\appendix
\section*{Appendice}
\section{Metodo di Runge-Kutta 4}
Per l'integrazione numerica abbiamo usato il metodo Runge-Kutta al quarto ordine, detto così perchè l'errore accumulato totale è dell'ordine di $ \mathcal{O}(h^{4}) $, mentre l'errore locale di troncamento è dell'ordine di $ \mathcal{O}(h^{5}) $. 
In generale, dato il seguente problema:
\begin{equation} \tag{A1}
\frac{dx}{dt}=f(x,t)\qquad x(t_{0})=x_{0}
\end{equation}
dove $ x $ è la funzione che si intende approssimare, scegliendo un intervallo $ h>0 $ e definendo:
\begin{equation} \tag{A2}
	x_{n+1}=x_{n}+\frac{1}{6}(k_{1}+2k_{2}+2k_{3}+k_{4})h \qquad t_{n+1}=t_{n}+h
\end{equation}
per $ 0<n<t_{f}/h $, dove $ t_{f} $ é il tempo finale. Usando:
\begin{equation} \tag{A3}
	\begin{aligned}
	&k_{1}=f(t_{n}, x_{n});\\
	&k_{2}=f(t_{n}+\frac{h}{2}, x_{n}+h\frac{k_{1}}{2});\\
	&k_{3}=f(t_{n}+\frac{h}{2}, x_{n}+h\frac{k_{2}}{2});\\
	&k_{4}=f(t_{n}+h, x_{n}+hk_{3});
\end{aligned}
\end{equation}
Per ogni $ n $, il valore successivo $ x_{n+1} $ da quello attuale $ x_{n} $ e dalla media pesata di quattro incrementi, i quali sono il prodotto dell'intervallo $ h $ e la pendenza data da $ f $. In particolare:
\begin{itemize}
	\item $ k_{1} $ é la pendenza all'inizio dell'intervallo, usando solo $ x $ 
	\item $ k_{2} $ é quella a metà intervallo, usando $ x $ e $ k_{1} $
	\item $ k_{3} $ è di nuovo a metà, ma usando $ x $ e $ k_{2} $
	\item $ k_{4} $ é quella alla fine, usando $ x $ e $ k_{3} $
\end{itemize}
Nella media pesata, si è dato un peso maggiore a $ k_{2} $ e $ k_{3} $.